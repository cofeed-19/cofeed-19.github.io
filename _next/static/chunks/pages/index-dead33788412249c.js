(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(2627)}])},1329:function(t,e,i){"use strict";function __WEBPACK_DEFAULT_EXPORT__(t){let{src:e}=t;return e}i.r(e),i.d(e,{default:function(){return __WEBPACK_DEFAULT_EXPORT__}})},2627:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return Home}});var r=i(5893),n=i(5675),o=i.n(n),l=i(7294),a=i(5003),s=i.n(a),c=i(6019),d=i(3485),u=i(7276),f=i(3646),p=i.n(f);let y=new(s());async function allStorage(){await (0,d.qZ)();let t=await (0,d.lj)();var e={};for(let i of t)e[i.url]=i;return e}function Home(){let[t,e]=(0,l.useState)(0),[i,n]=(0,l.useState)({}),[a,s]=(0,l.useState)({total:0,loaded:0}),f=(0,l.useCallback)(async()=>{let t=0,r=await allStorage(),o=Object.keys(r).length;for(let e of(n(r),s(t=>({...t,total:o,loaded:o})),Object.keys(r))){if(e in i){r[e]={...i[e],visited:r[e].visited,priority:r[e].priority};continue}try{let i=await y.parseURL(e),n=await (0,u.KU)(i.link),o={...i,url:e,favicon:n,visited:r[e].visited||{},priority:r[e].priority};o.priority&&o.priority>t&&(t=o.priority),r[e]=o}catch(t){console.error("Could not update feed for ".concat(e))}s(t=>({...t,loaded:t.loaded+1}))}e(t),n(r)},[i]);async function onSubmit(t){let e=t.trim().split(",").filter(Boolean),i=[];for(let t of e){let e;try{e=await y.parseURL(t)}catch(e){i.push(t)}if(e&&!await (0,d.bd)(t)){let i=await (0,u.KU)(e.link);await (0,d.jP)({url:t,visited:{},favicon:i,priority:0,...e})}}i.length&&alert("Could not add:\n".concat(i.join("\n"),"\n\nProbable CORS issue\uD83D\uDE22!\nMaybe ask website owner to enable CORS\uD83E\uDD14!\nOr install browser extension to allow CORS: https://mybrowseraddon.com/access-control-allow-origin.html")),f()}let _=(0,l.useMemo)(()=>{let t=Object.keys(i);return t.sort((t,e)=>{var r,n;let o=i[t],l=i[e],a=null!==(r=o.priority)&&void 0!==r?r:0,s=null!==(n=l.priority)&&void 0!==n?n:0;return a>s?-1:a<s?1:0}),t},[i]),m=(0,l.useCallback)(async r=>{let n=_.map(t=>i[t]).map(e=>e.url===r.url?{...e,priority:r.priority?void 0:t+1}:e);n.sort((t,e)=>t.priority&&e.priority?t.priority-e.priority:t.priority?-1:e.priority?1:0);let o=n.map((t,e)=>t.priority?{...t,priority:e+1}:t);for(let t of o)await (0,d.eS)(t);e(o.length),f()},[t,_,i]);return(0,l.useEffect)(()=>{f()},[]),(0,l.useEffect)(()=>{a.loaded>a.total&&s({...a,loaded:a.total})},[a]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.NC,{}),(0,r.jsx)(c.h4,{}),(0,r.jsxs)("main",{className:p().container,children:[(0,r.jsx)(c.Ob,{onSubmit:onSubmit}),(0,r.jsx)(c.s0,{loadedFeeds:a}),_.map(t=>{let e=i[t],n=e.items.filter(t=>t.link&&(!e.visited||!e.visited[t.link])),l=e.items.filter(t=>t.link&&e.visited&&e.visited[t.link]);return(0,r.jsxs)("section",{className:p().feed,children:[(0,r.jsxs)("h3",{children:[(0,r.jsx)(c.fE,{feed:e,onClick:m}),e.link?(0,r.jsxs)(r.Fragment,{children:[e.favicon&&(0,r.jsx)(o(),{alt:e.title||t,src:e.favicon,width:16,height:16,unoptimized:!0}),(0,r.jsx)(c.dL,{link:e.link,title:e.title})]}):e.title||t," ",(0,r.jsx)("button",{onClick:()=>{var i;return i=e.title,void(confirm("Delete ".concat(i," from feeds?"))&&((0,d.vs)(t),f()))},children:"‚ùå"})]}),(0,r.jsx)(c.lZ,{feed:e,feedUrl:t,newItems:n,updateFeeds:f}),(0,r.jsx)(c.xx,{feed:e,feedUrl:t,visitedItems:l})]},t)})]}),(0,r.jsx)(c.$_,{})]})}},3646:function(t){t.exports={container:"styles_container__TE5Ij",feed:"styles_feed__NGz8S"}}},function(t){t.O(0,[241,214,19,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);